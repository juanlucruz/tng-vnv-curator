{
  "test_descriptor":{
    "descriptor_schema":"https://raw.githubusercontent.com/sonata-nfv/tng-schema/master/test-descriptor/testdescriptor-schema.yml",
    "vendor":"eu.5gtango.atos",
    "name":"test-immersive-media",
    "version":"0.1",
    "author":"Ignacio Dominguez, Felipe Vicens (ATOS)",
    "description":"Performance test for video analysis",
    "service_platforms":[
      "SONATA"
    ],
    "test_tags":[
      "rtmp-media-service"
    ],
    "test_category":[
      "benchmarking"
    ],
    "phases":[
      {
        "id":"setup",
        "steps":[
          {
            "name":"deployment",
            "description":"Deploying a NS",
            "action":"deploy"
          },
          {
            "name":"configuration",
            "description":null,
            "action":"configure",
            "probes":[
              {
                "id":"initiator",
                "name":"initiator",
                "image":"sonatanfv/tng-media-pilot-initiator",
                "description":"A service initial configuration container",
                "parameters":[
                  {
                    "key":"CAMERA",
                    "value":"test"
                  },
                  {
                    "key":"CMS",
                    "value":"$(default-vnf0/endpoints/id:output/address)"
                  }
                ]
              },
              {
                "id":"cpe",
                "name":"cpe",
                "image":"sonatanfv/tng-media-pilot-cpe",
                "description":"Content Producer Emulator (CPE) To generate a RTMP flow",
                "parameters":[
                  {
                    "key":"AGGREGATOR",
                    "value":"$(default-vnf0/endpoints/id:mgmt/address)"
                  },
                  {
                    "key":"APP",
                    "value":"test"
                  },
                  {
                    "key":"STREAM",
                    "value":"test"
                  }
                ]
              },
              {
                "id":"cce",
                "name":"cce",
                "image":"sonatanfv/tng-media-pilot-cce",
                "description":"Content Consumer Emulator (CCE) To play HLS flows from Streaming engine",
                "parameters":[
                  {
                    "key":"STREAMMING_ENGINE",
                    "value":"$(default-vnf0/endpoints/id:input/address)"
                  },
                  {
                    "key":"STREAM",
                    "value":"test"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "id":"excercise",
        "steps":[
          {
            "name":"configure_service",
            "description":"Configuration of the service previuos start tests",
            "run":"initiator",
            "index":0,
            "start_delay":0,
            "instances":1,
            "output":[
              {
                "results":"logs.txt",
                "verdict":"status.txt"
              }
            ]
          },
          {
            "name":"run_camera",
            "description":"Starting the CPE that simulates the camera",
            "run":"cpe",
            "index":1,
            "start_delay":5,
            "instances":1,
            "output":[
              {
                "results":"logs.txt",
                "graphs":"detail.json"
              }
            ],
            "dependencies":[
              "initiator"
            ]
          },
          {
            "name":"run_players",
            "description":"Starting the CCE that simulates the consumer",
            "run":"cce",
            "index":2,
            "start_delay":15,
            "instances":10,
            "output":[
              {
                "results":"logs.txt",
                "graphs":"detail.json"
              }
            ],
            "dependencies":[
              "cpe"
            ]
          }
        ]
      },
      {
        "id":"verification",
        "steps":[
          {
            "name":"configuration",
            "description":"Check service was configured",
            "step":"configure_service",
            "condition":[
              {
                "parser":[
                  {
                    "file":"status.txt",
                    "find":"OK",
                    "value":"present",
                    "verdict":"pass"
                  }
                ]
              }
            ]
          },
          {
            "name":"user_experience",
            "description":"Check bandwithd received",
            "step":"run_players",
            "condition":[
              {
                "parser":[
                  {
                    "file":"detail.json",
                    "type":"json",
                    "find":"error_rate",
                    "value":"< 0.05",
                    "verdict":"pass"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "network_service_descriptor": {
    "descriptor_schema":"https://raw.githubusercontent.com/sonata-nfv/tng-schema/master/service-descriptor/nsd-schema.yml",
    "vendor":"eu.5gtango",
    "name":"5gtango-project-sample",
    "version":"0.1",
    "author":"5GTANGO Developer",
    "description":"Default description",
    "network_functions":[
      {
        "vnf_id":"vnf0",
        "vnf_vendor":"eu.5gtango",
        "vnf_name":"default-vnf0",
        "vnf_version":"0.9"
      }
    ],
    "connection_points":[
      {
        "id":"mgmt",
        "interface":"ipv4",
        "type":"management"
      },
      {
        "id":"input",
        "interface":"ipv4",
        "type":"external"
      },
      {
        "id":"output",
        "interface":"ipv4",
        "type":"external"
      }
    ],
    "virtual_links":[
      {
        "id":"mgmt",
        "connectivity_type":"E-LAN",
        "connection_points_reference":[
          "vnf0:mgmt",
          "mgmt"
        ]
      },
      {
        "id":"input-2-vnf1",
        "connectivity_type":"E-Line",
        "connection_points_reference":[
          "input",
          "vnf0:input"
        ]
      },
      {
        "id":"vnf0-2-output",
        "connectivity_type":"E-Line",
        "connection_points_reference":[
          "vnf0:output",
          "output"
        ]
      }
    ]
  },
  "paths":""
}