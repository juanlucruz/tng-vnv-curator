{
  "test_descriptor":{
    "descriptor_schema":"https://raw.githubusercontent.com/sonata-nfv/tng-schema/master/test-descriptor/testdescriptor-schema.yml",
    "vendor":"eu.5gtango.atos",
    "name":"test-immersive-media",
    "version":"0.1",
    "author":"Ignacio Dominguez, Felipe Vicens (ATOS)",
    "description":"\"Performance test for video analysis\"\n",
    "service_platforms":[
      "SONATA"
    ],
    "test_tags":[
      "rtmp-media-service"
    ],
    "test_category":[
      "benchmarking"
    ],
    "phases":[
      {
        "id":"setup",
        "steps":[
          {
            "name":"deployment",
            "description":"Deploying a NS",
            "action":"deploy"
          },
          {
            "name":"configuration",
            "description":null,
            "action":"configure",
            "probes":[
              {
                "id":"initiator",
                "name":"initiator",
                "image":"sonatanfv/tng-media-pilot-initiator",
                "description":"A service initial configuration container",
                "parameters":[
                  {
                    "key":"CAMERA",
                    "value":"test"
                  },
                  {
                    "key":"CMS",
                    "value":"cms-vnfd.api.serviceendpoint"
                  }
                ]
              },
              {
                "id":"cpe",
                "name":"cpe",
                "image":"sonatanfv/tng-media-pilot-cpe",
                "description":"Content Producer Emulator (CPE) To generate a RTMP flow",
                "parameters":[
                  {
                    "key":"AGGREGATOR",
                    "value":"ma-vnfd.rtmp.serviceendpoint"
                  },
                  {
                    "key":"APP",
                    "value":"test"
                  },
                  {
                    "key":"STREAM",
                    "value":"test"
                  }
                ]
              },
              {
                "id":"cce",
                "name":"cce",
                "image":"sonatanfv/tng-media-pilot-cce",
                "description":"Content Consumer Emulator (CCE) To play HLS flows from Streaming engine",
                "parameters":[
                  {
                    "key":"STREAMMING_ENGINE",
                    "value":"mse-vnfd.hls.serviceendpoint"
                  },
                  {
                    "key":"STREAM",
                    "value":"test"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "id":"excercise",
        "steps":[
          {
            "name":"configure_service",
            "description":"Configuration of the service previuos start tests",
            "run":"initiator",
            "index":0,
            "start_delay":0,
            "instances":1,
            "output":[
              {
                "results":"logs.txt",
                "verdict":"status.txt"
              }
            ]
          },
          {
            "name":"run_camera",
            "description":"Starting the CPE that simulates the camera",
            "run":"cpe",
            "index":1,
            "start_delay":5,
            "instances":1,
            "output":[
              {
                "results":"logs.txt",
                "graphs":"detail.json"
              }
            ],
            "dependencies":[
              "initiator"
            ]
          },
          {
            "name":"run_players",
            "description":"Starting the CCE that simulates the consumer",
            "run":"cce",
            "index":2,
            "start_delay":15,
            "instances":10,
            "output":[
              {
                "results":"logs.txt",
                "graphs":"detail.json"
              }
            ],
            "dependencies":[
              "cpe"
            ]
          }
        ]
      },
      {
        "id":"verification",
        "steps":[
          {
            "name":"configuration",
            "description":"Check service was configured",
            "step":"configure_service",
            "condition":[
              {
                "parser":[
                  {
                    "file":"status.txt",
                    "find":"OK",
                    "value":"present",
                    "verdict":"pass"
                  }
                ]
              }
            ]
          },
          {
            "name":"user_experience",
            "description":"Check bandwithd received",
            "step":"run_players",
            "condition":[
              {
                "parser":[
                  {
                    "file":"detail.json",
                    "type":"json",
                    "find":"error_rate",
                    "value":"< 0.05",
                    "verdict":"pass"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "network_service_descriptor":{
    "descriptor_schema":"https://raw.githubusercontent.com/sonata-nfv/tng-schema/master/service-descriptor/nsd-schema.yml",
    "vendor":"eu.5gtango",
    "name":"default-nsd",
    "version":"0.9",
    "author":"5GTANGO Developer",
    "description":"A default NSD with one default VNFDs",
    "network_functions":[
      {
        "vnf_id":"vnf1",
        "vnf_vendor":"eu.5gtango",
        "vnf_name":"ubuntu-vnf",
        "vnf_version":"0.9"
      }
    ],
    "connection_points":[
      {
        "id":"mgmt",
        "interface":"ipv4",
        "type":"management"
      },
      {
        "id":"input",
        "interface":"ipv4",
        "type":"external"
      },
      {
        "id":"output",
        "interface":"ipv4",
        "type":"external"
      }
    ],
    "virtual_links":[
      {
        "id":"mgmt",
        "connectivity_type":"E-LAN",
        "connection_points_reference":[
          "vnf1:mgmt",
          "vnf2:mgmt",
          "mgmt"
        ]
      },
      {
        "id":"input-2-vnf1",
        "connectivity_type":"E-Line",
        "connection_points_reference":[
          "input",
          "vnf1:input"
        ]
      },
      {
        "id":"vnf1-2-output",
        "connectivity_type":"E-Line",
        "connection_points_reference":[
          "vnf1:output",
          "output"
        ]
      }
    ],
    "forwarding_graphs":[
      {
        "fg_id":"fg01",
        "number_of_endpoints":2,
        "number_of_virtual_links":2,
        "constituent_virtual_links":[
          "input-2-vnf1",
          "vnf1-2-output"
        ],
        "constituent_vnfs":[
          "vnf1"
        ],
        "network_forwarding_paths":[
          {
            "fp_id":"fg01:fp01",
            "policy":"none",
            "connection_points":[
              {
                "connection_point_ref":"input",
                "position":1
              },
              {
                "connection_point_ref":"vnf1:input",
                "position":2
              },
              {
                "connection_point_ref":"vnf1:output",
                "position":3
              },
              {
                "connection_point_ref":"output",
                "position":4
              }
            ]
          }
        ]
      }
    ]
  },
  "paths":"",
}